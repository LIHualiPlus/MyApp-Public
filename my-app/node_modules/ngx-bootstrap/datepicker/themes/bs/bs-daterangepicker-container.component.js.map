{"version":3,"file":"bs-daterangepicker-container.component.js","sourceRoot":"","sources":["../../../../.tmp/datepicker/themes/bs/bs-daterangepicker-container.component.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,OAAO,EAAE,SAAS,EAAE,YAAY,EAAqB,MAAM,eAAe,CAAC;AAC3E,OAAO,EAAE,6BAA6B,EAAE,MAAM,oCAAoC,CAAC;AACnF,OAAO,EAAE,kBAAkB,EAAE,MAAM,4BAA4B,CAAC;AAEhE,OAAO,EAAE,mBAAmB,EAAE,MAAM,qCAAqC,CAAC;AAC1E,OAAO,EAAE,mBAAmB,EAAE,MAAM,qCAAqC,CAAC;AAC1E,OAAO,EAAE,iBAAiB,EAAE,MAAM,mCAAmC,CAAC;;IAcb,uDAA6B;IAUpF,6CACU,OAA2B,EAC3B,MAAyB,EACzB,QAA6B,EACrC,QAA6B;QAJ/B,YAME,iBAAO,SAER;QAPS,aAAO,GAAP,OAAO,CAAoB;QAC3B,YAAM,GAAN,MAAM,CAAmB;QACzB,cAAQ,GAAR,QAAQ,CAAqB;4BAPzB,IAAI,YAAY,EAAU;4BAElB,EAAE;sBACA,EAAE;QAQxB,KAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;;KAC1B;IAhBD,sBAAI,sDAAK;aAAT,UAAU,KAAa;YACrB,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;SACpC;;;OAAA;IAgBD,sDAAQ,GAAR;QAAA,iBAoBC;QAnBC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC;QAClD,IAAI,CAAC,QAAQ;aACV,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;aAGjB,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC;aAExB,WAAW,CAAC,IAAI,CAAC;aAEjB,gBAAgB,CAAC,IAAI,CAAC;aACtB,6BAA6B,EAAE,CAAC;;;QAInC,IAAI,CAAC,KAAK,CAAC,IAAI,CACb,IAAI,CAAC,MAAM;aACR,MAAM,CAAC,UAAA,KAAK,IAAI,OAAA,KAAK,CAAC,aAAa,EAAnB,CAAmB,CAAC;aACpC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,EAA3B,CAA2B,CAAC,CAClD,CAAC;KACH;IAED,8DAAgB,GAAhB,UAAiB,GAAiB;QAChC,EAAE,CAAC,CAAC,GAAG,CAAC,YAAY,IAAI,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC;YACvC,MAAM,CAAC;SACR;;;;;;QAOD,EAAE,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;YAClC,IAAI,CAAC,WAAW;gBACd,GAAG,CAAC,IAAI,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC;oBAC7B,CAAC,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,IAAI,CAAC;oBACjC,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;SAClB;QAED,EAAE,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;YAClC,IAAI,CAAC,WAAW,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;SAC/B;QAED,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC;QAElE,EAAE,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;YAClC,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;SACvB;KACF;IAED,yDAAW,GAAX;QACE,GAAG,CAAC,CAAc,UAAU,EAAV,KAAA,IAAI,CAAC,KAAK,EAAV,cAAU,EAAV,IAAU;YAAvB,IAAM,GAAG,SAAA;YACZ,GAAG,CAAC,WAAW,EAAE,CAAC;SACnB;QACD,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,CAAC;KACzB;;gBAtFF,SAAS,SAAC;oBACT,QAAQ,EAAE,8BAA8B;oBACxC,SAAS,EAAE,CAAC,iBAAiB,EAAE,mBAAmB,CAAC;oBACnD,QAAQ,EAAE,23DAA23D;oBACr4D,IAAI,EAAE;wBACJ,SAAS,EAAE,0BAA0B;wBACrC,KAAK,EAAE,qCAAqC;wBAC5C,IAAI,EAAE,QAAQ;wBACd,YAAY,EAAE,UAAU;qBACzB;iBACF;;;;gBAjBQ,kBAAkB;gBAIlB,iBAAiB;gBAFjB,mBAAmB;gBACnB,mBAAmB;;8CAL5B;EAoByD,6BAA6B;SAAzE,mCAAmC","sourcesContent":["import { Component, EventEmitter, OnDestroy, OnInit } from '@angular/core';\nimport { BsDatepickerAbstractComponent } from '../../base/bs-datepicker-container';\nimport { BsDatepickerConfig } from '../../bs-datepicker.config';\nimport { DayViewModel } from '../../models/index';\nimport { BsDatepickerActions } from '../../reducer/bs-datepicker.actions';\nimport { BsDatepickerEffects } from '../../reducer/bs-datepicker.effects';\nimport { BsDatepickerStore } from '../../reducer/bs-datepicker.store';\nimport { Subscription } from 'rxjs';\n\n@Component({\n  selector: 'bs-daterangepicker-container',\n  providers: [BsDatepickerStore, BsDatepickerEffects],\n  template: \"<!-- days calendar view mode --> <div class=\\\"bs-datepicker\\\" [ngClass]=\\\"containerClass\\\" *ngIf=\\\"viewMode | async\\\"> <div class=\\\"bs-datepicker-container\\\"> <!--calendars--> <div class=\\\"bs-calendar-container\\\" [ngSwitch]=\\\"viewMode | async\\\" role=\\\"application\\\"> <!--days calendar--> <div *ngSwitchCase=\\\"'day'\\\"> <bs-days-calendar-view *ngFor=\\\"let calendar of (daysCalendar | async)\\\" [class.bs-datepicker-multiple]=\\\"(daysCalendar | async)?.length > 1\\\" [calendar]=\\\"calendar\\\" [options]=\\\"options | async\\\" (onNavigate)=\\\"navigateTo($event)\\\" (onViewMode)=\\\"setViewMode($event)\\\" (onHover)=\\\"dayHoverHandler($event)\\\" (onSelect)=\\\"daySelectHandler($event)\\\" ></bs-days-calendar-view> </div> <!--months calendar--> <div *ngSwitchCase=\\\"'month'\\\"> <bs-month-calendar-view *ngFor=\\\"let calendar of (monthsCalendar | async)\\\" [class.bs-datepicker-multiple]=\\\"(daysCalendar | async)?.length > 1\\\" [calendar]=\\\"calendar\\\" (onNavigate)=\\\"navigateTo($event)\\\" (onViewMode)=\\\"setViewMode($event)\\\" (onHover)=\\\"monthHoverHandler($event)\\\" (onSelect)=\\\"monthSelectHandler($event)\\\" ></bs-month-calendar-view> </div> <!--years calendar--> <div *ngSwitchCase=\\\"'year'\\\"> <bs-years-calendar-view *ngFor=\\\"let calendar of (yearsCalendar | async)\\\" [class.bs-datepicker-multiple]=\\\"(daysCalendar | async)?.length > 1\\\" [calendar]=\\\"calendar\\\" (onNavigate)=\\\"navigateTo($event)\\\" (onViewMode)=\\\"setViewMode($event)\\\" (onHover)=\\\"yearHoverHandler($event)\\\" (onSelect)=\\\"yearSelectHandler($event)\\\" ></bs-years-calendar-view> </div> </div> <!--applycancel buttons--> <div class=\\\"bs-datepicker-buttons\\\" *ngIf=\\\"false\\\"> <button class=\\\"btn btn-success\\\">Apply</button> <button class=\\\"btn btn-default\\\">Cancel</button> </div> </div> <!--custom dates or date ranges picker--> <div class=\\\"bs-datepicker-custom-range\\\" *ngIf=\\\"false\\\"> <bs-custom-date-view [ranges]=\\\"_customRangesFish\\\"></bs-custom-date-view> </div> </div> \",\n  host: {\n    '(click)': '_stopPropagation($event)',\n    style: 'position: absolute; display: block;',\n    role: 'dialog',\n    'aria-label': 'calendar'\n  }\n})\nexport class BsDaterangepickerContainerComponent extends BsDatepickerAbstractComponent\n  implements OnInit, OnDestroy {\n  set value(value: Date[]) {\n    this._effects.setRangeValue(value);\n  }\n\n  valueChange = new EventEmitter<Date[]>();\n\n  _rangeStack: Date[] = [];\n  _subs: Subscription[] = [];\n  constructor(\n    private _config: BsDatepickerConfig,\n    private _store: BsDatepickerStore,\n    private _actions: BsDatepickerActions,\n    _effects: BsDatepickerEffects\n  ) {\n    super();\n    this._effects = _effects;\n  }\n\n  ngOnInit(): void {\n    this.containerClass = this._config.containerClass;\n    this._effects\n      .init(this._store)\n      // intial state options\n      // todo: fix this, split configs\n      .setOptions(this._config)\n      // data binding view --> model\n      .setBindings(this)\n      // set event handlers\n      .setEventHandlers(this)\n      .registerDatepickerSideEffects();\n\n    // todo: move it somewhere else\n    // on selected date change\n    this._subs.push(\n      this._store\n        .select(state => state.selectedRange)\n        .subscribe(date => this.valueChange.emit(date))\n    );\n  }\n\n  daySelectHandler(day: DayViewModel): void {\n    if (day.isOtherMonth || day.isDisabled) {\n      return;\n    }\n\n    // if only one date is already selected\n    // and user clicks on previous date\n    // start selection from new date\n    // but if new date is after initial one\n    // than finish selection\n    if (this._rangeStack.length === 1) {\n      this._rangeStack =\n        day.date >= this._rangeStack[0]\n          ? [this._rangeStack[0], day.date]\n          : [day.date];\n    }\n\n    if (this._rangeStack.length === 0) {\n      this._rangeStack = [day.date];\n    }\n\n    this._store.dispatch(this._actions.selectRange(this._rangeStack));\n\n    if (this._rangeStack.length === 2) {\n      this._rangeStack = [];\n    }\n  }\n\n  ngOnDestroy(): void {\n    for (const sub of this._subs) {\n      sub.unsubscribe();\n    }\n    this._effects.destroy();\n  }\n}\n"]}